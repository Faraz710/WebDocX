<!DOCTYPE html>
<html>
    <head>
        <style>
            .info {
                color: #555555;
                text-align: center;
            }

            .info span {
                color: #111111;
            }

            .patient {
                float:left;
                text-align: left;
            }

            .metadata {
                float:right;
                text-align: right;
            }

            .medicines {
                color: #555555;
            }

            .medicines span {
                color: #111111;
            }
            
            .clear { clear:both; }

            #logo {
                position: absolute;
                margin-left: 2.5%;
                height: 30pt;
                width: 30pt;
            }
            p {
              margin: 2pt;
            }

            hr {
                color: #555555;
            }

            body {
              font-family: Sans-Serif;
            }
        </style>
    </head>
    <body>
        <div>
            <img id="logo" src="data:image/png;base64,<%=logoBuffer%>" alt="Webdocx">
        </div>
        <div style="width: 95%; height: 100%; margin: 0 2.5%;">
            <div style="font-size: 7pt">	
                <% if (prescription) { %>
                    <div class="info"> 
			         <p><span>Dr. <%= prescription.doctor.name %></span></p>
			         <p><%= prescription.doctor.qualification %></p>
			         <p>Medical Registration Number: <%= prescription.doctor.reg_no %></p>
                    </div>
                    <hr>
                    
                    <div class="info patient">
                        <p><span><%= prescription.patient.name %></span></p>
                        <p>Age: <%= prescription.patient.age %>, Gender: <%= prescription.patient.gender %>.</p>
                    </div>

                    <div class="info metadata">
                        <p>Prescription Id: <%= prescription._id %></p>
                        <p><%= prescription.issuingDate %></p>
                    </div>
                    <div class="clear"></div>
                    <br>
                    <div class="info" style="text-align: left">
                        <p><span>Symptoms:</span> <%= prescription.symptoms %></p>
                        <p><span>Diagnosis:</span> <%= prescription.diagnosis %></p>
                    </div>

                    <div class="medicines">
                        <h2> <span> Medicines </span></h2>
                        
                        <% if (prescription.medicines.length > 0) { %>
                            <% prescription.medicines.forEach(medicine => {%>
                            <div>
                                <p><span><%= medicine.name %></span></p>
                                <div style="float:left"><p><%= medicine.dosage %> time(s) a day x <%= medicine.duration %> days</p></div>
                                <div style="float:right"><p><%= medicine.instruction %></p></div>
                                <div class="clear"></div>
                                <br>
                            <%  });%>
                            </div>
                        <% }%>
                    </div>

                    <hr>
                    <div class="info" style="text-align: left">
                        <p><span>Additional remarks:</span> <%= prescription.remarks %></p>
                        <br>
                    </div>

                    <div class="info" style="float:right;margin-top:10%">
                        <% if (typeof prescription.doctor.digitalSign.data !== 'undefined') {
                            var image = Buffer.from(prescription.doctor.digitalSign.data).toString('base64');
                            var type = prescription.doctor.digitalSign.contentType;
                        }%>
                        <img style="width:35px;height:35px;" src="data:<%= type %>;base64,<%= image %>" /> 
                        <p> Doctor's Signature<br>
                        <%= prescription.issuingDate %></p>
                    </div>
                    <div class="clear"></div>

                <% } %>
            </div>
        </div>
    </body>
</html>
